<!DOCTYPE html>
<html>
  <head>
    <style>
      /*! ADAPTED
    Typeplate : Starter Kit
    URL ........... http://typeplate.com
    Version ....... 3.0.2
    Github ........ https://github.com/typeplate/starter-kit
    Authors ....... Dennis Gaebel (@gryghostvisuals) & Zachary Kain (@zakkain)
    License ....... Creative Commmons Attribution 3.0
    License URL ... https://github.com/typeplate/starter-kit/blob/master/license.txt
    */

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        text-rendering: optimizeLegibility;
        line-height: 1;
        margin-top: 0;
        color: #222;
      }

      blockquote + figcaption cite {
        display: block;
        font-size: inherit;
        text-align: right;
      }

      body {
        word-wrap: break-word;
      }

      pre code {
        word-wrap: normal;
      }

      body {
        -webkit-hyphens: auto;
        -ms-hyphens: auto;
        hyphens: auto;
        color: #444;
      }

      h1 {
        font-size: 2em;
        /* 2*16 = 32 */
      }

      h2 {
        font-size: 1.5em;
        /* 1.5*16 = 24 */
      }

      h3 {
        font-size: 1.17em;
        /* 1.17*16 = 18.72 */
      }

      h4 {
        font-size: 1em;
        /* 1*16 = 16 */
      }

      h5 {
        font-size: 0.83em;
        /* 0.83*16 = 13.28 */
      }

      h6 {
        font-size: 0.75em;
        /* 0.75*16 = 12 */
      }

      h1 {
        margin: 2.42424rem 0 1.454544rem;
      }

      h2 {
        margin: 2.0202rem 0 1.21212rem;
      }

      h3 {
        margin: 1.61616rem 0 1rem;
      }

      h4 {
        margin: 1.21212rem 0 1;
      }

      h5 {
        margin: 0.80808rem 0;
      }

      h6 {
        margin: 0.70707rem 0;
      }

      p {
        margin: auto auto 1.5rem;
      }

      small {
        font-size: 65%;
      }

      input,
      abbr,
      acronym,
      blockquote,
      code,
      kbd,
      q,
      samp,
      var {
        -webkit-hyphens: none;
        -ms-hyphens: none;
        hyphens: none;
      }

      pre {
        white-space: pre;
      }

      pre code {
        white-space: -moz-pre-wrap;
        white-space: pre-wrap;
      }

      code {
        white-space: pre;
        font-family: SF Mono, Consolas, Dejavu Sans Mono, Menlo, monospace;
      }

      abbr {
        -webkit-font-variant: small-caps;
        -moz-font-variant: small-caps;
        -ms-font-variant: small-caps;
        font-variant: small-caps;
        font-weight: 600;
        text-transform: lowercase;
        color: gray;
      }

      abbr[title]:hover {
        cursor: help;
      }

      /* FROM http://purecss.io/layouts/side-menu/  adapted to remove pure classes*/

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
          "Segoe UI Symbol";
        color: #444;
      }

      img {
        max-width: 100%;
        height: auto;
        display: block;
        margin: auto;
      }

      code,
      pre {
        background-color: #f5f5f5;
        color: #444;
        border-radius: 2px;
        text-shadow: 0px 1px 0px white;
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.15);
      }

      pre code {
        border: none;
        box-shadow: none;
      }

      pre {
        padding: 0.5em;
      }

      code {
        display: inline-block;
        padding: 0 0.5em;
        line-height: 1.4;
        font-size: 0.9em;
      }

      table {
        border-spacing: 0;
        margin-bottom: 1.5rem;
      }

      table th,
      table td {
        padding: 0.3em 0.7em;
      }

      table th {
        background-color: #f4f4f4;
        border-bottom: 2px solid #444;
      }

      table td {
        border: 1px solid #f5f5f5;
      }

      /* Add transition to containers so they can push in and out. */

      #layout,
      #menu,
      .menu-link {
        -webkit-transition: all 0.2s ease-out;
        -moz-transition: all 0.2s ease-out;
        -ms-transition: all 0.2s ease-out;
        -o-transition: all 0.2s ease-out;
        transition: all 0.2s ease-out;
      }

      /* This is the parent `<div>` that contains the menu and the content area. */

      #layout {
        position: relative;
        padding-left: 0;
      }

      #layout.active #menu {
        left: 250px;
        width: 250px;
      }

      #layout.active .menu-link {
        left: 250px;
      }

      /* The content `<div>` is where all your content goes. */

      .content {
        margin: 50px auto;
        padding: 0 2em;
        max-width: 80ex;
        line-height: 1.6em;
      }

      /*
      The `#menu` `<div>` is the parent `<div>` that contains the menu that
      appears on the left side of the page.
      */

      #menu {
        margin-left: -250px;
        /* "#menu" width */
        width: 250px;
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        z-index: 1000;
        /* so the menu or its navicon stays above all content */
        background: #f4f4f4;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        font-size: 0.9em;
      }

      @media print {
        #menu,
        .menu-link {
          display: none !important;
        }
      }

      a,
      a * {
        text-decoration: none;
        color: #2483cc;
      }

      a:visited {
        text-decoration: none;
        color: #2483cc;
      }

      /* All anchors inside the menu should be styled like this. */

      #menu a {
        display: block;
        padding: 0.5em 0.5em;
      }

      #menu a:first-letter {
        text-transform: capitalize;
      }

      #menu ul {
        list-style-type: none;
        padding: 0;
        margin: 1em 0.5em;
      }

      #menu ul ul {
        margin-top: 0.5em;
        margin-left: 0.5em;
        border-left: 4px solid rgba(255, 255, 255, 0.5);
      }

      /* Change color of the anchor links on hover/focus. */

      #menu li a:hover,
      #menu li a:focus {
        background: rgba(255, 255, 255, 0.4);
      }

      /* This styles the selected menu item `<li>`. */

      #menu li a.active {
        background: rgba(0, 0, 0, 0.05);
      }

      /* This styles a link within a selected menu item `<li>`. */

      #menu li a.active {
        color: #222;
      }

      /* This styles the menu heading. */

      #menu li.heading {
        font-size: 0.9em;
        text-transform: uppercase;
        color: #000;
      }

      #menu li.heading > * {
        padding: 0.5em;
        display: block;
      }

      #menu li.heading a {
        color: #0c68af;
      }

      /* -- Dynamic Button For Responsive Menu -------------------------------------*/

      /*
      `.menu-link` represents the responsive menu toggle that shows/hides on
      small screens.
      */

      .menu-link {
        position: fixed;
        display: block;
        /* show this only on small screens */
        top: 0;
        left: 0;
        /* "#menu width" */
        font-size: 10px;
        /* change this value to increase/decrease button size */
        z-index: 10;
        width: 2em;
        height: auto;
        padding: 1.6em 1.2em;
        border-radius: 0 2px 2px 0;
      }

      .menu-link:hover {
        background: #f4f4f4;
      }

      .menu-link span {
        position: relative;
        display: block;
      }

      .menu-link span,
      .menu-link span:before,
      .menu-link span:after {
        background-color: #555;
        width: 100%;
        height: 0.2em;
        border-radius: 1em;
      }

      .menu-link span:before,
      .menu-link span:after {
        position: absolute;
        margin-top: -0.6em;
        content: " ";
      }

      .menu-link span:after {
        margin-top: 0.6em;
      }

      /* Hides the menu at `48em`, but modify this based on your app's needs. */

      @media (min-width: 48em) {
        .header,
        .content {
          padding-left: 2em;
          padding-right: 2em;
        }

        #layout {
          padding-left: 250px;
          /* left col width "#menu" */
          left: 0;
        }
        #menu {
          left: 250px;
        }

        .menu-link {
          position: fixed;
          left: 250px;
          display: none;
        }

        #layout.active .menu-link {
          left: 250px;
        }
      }

      @media (max-width: 48em) {
        /* Only apply this when the window is small. Otherwise, the following case results in extra padding on the left:
         * Make the window small.
         * Tap the menu to trigger the active state.
         * Make the window large again.
         */
        #layout.active {
          position: relative;
          left: 250px;
        }
      }

      /* Heading anchors and permalinks */
      h1[id],
      h2[id],
      h3[id],
      h4[id],
      h5[id],
      h6[id] {
        position: relative;
      }
      .heading-anchor-permalink {
        /* Position the permalink to the left of the title */
        position: absolute;
        right: 100%;
        /* Add some spacing as padding to not lose the hover */
        padding-right: 0.6rem;
        /* Make it only visible on heading hover, see below */
        opacity: 0;
      }
      h1[id]:hover .heading-anchor-permalink,
      h2[id]:hover .heading-anchor-permalink,
      h3[id]:hover .heading-anchor-permalink,
      h4[id]:hover .heading-anchor-permalink,
      h5[id]:hover .heading-anchor-permalink,
      h6[id]:hover .heading-anchor-permalink {
        opacity: 0.5;
      }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="layout">
      <!-- Menu toggle -->
      <a href="#menu" id="menuLink" class="menu-link">
        <!-- Hamburger icon -->
        <span></span>
      </a>
      <nav id="menu">
        <ul>
<li><a class="" href="index.html">index</a></li>
<li><a class="" href="asgi-dispatcher-middleware.html">asgi dispatcher middleware</a></li>
<li><a class="" href="clojure-unknown-tool-tools.html">clojure unknown tool tools</a></li>
<li><a class="" href="django-apps-in-a-polylith.html">django apps in a polylith</a></li>
<li><a class="" href="mongodb-mass-removing-nested-array-element-property.html">mongodb mass removing nested array element property</a></li>
<li><a class="" href="needlestack.html">needlestack</a></li>
<li><a class="" href="python-pydantic-unprintable-validationerror-object.html">python pydantic unprintable validationerror object</a></li>
<li><a class="active" href="routing-pattern-for-html6-htmx-applications.html">routing pattern for html6 htmx applications</a></li>
<li><a class="" href="solana-mental-model.html">solana mental model</a></li>
<li><a class="" href="xfce4-slock-red-screen.html">xfce4 slock red screen</a></li>
<li><a class="" href="xinput-synaptics-disable-while-typing.html">xinput synaptics disable while typing</a></li>
</ul>
      </nav>
      <article id="main" class="content">
        <h1 id="routing-pattern-for-html6-(htmx)-applications">routing pattern for HTML6 (HTMX) applications <a class="heading-anchor-permalink" href="#routing-pattern-for-html6-(htmx)-applications">#</a></h1>
<p>Gonna keep this one short - I think I’ve discovered the ideal pattern to URL routing for an HTML6 (HTMX) application.</p>
<p>First time I used HTMX was for a hobby project that I myself regularly use, and I’d sprinkle a bit of dynamic loading here and there.
Initially is was just an MPA where some hierarchical data structure is dictated by the URL currently open.
The dynamic behavior was all done with buttons in forms with some occasional JS ,and full page reloads happened on most events.</p>
<p>The application evolved a bit and HTMX requests went to dynamic functionality handled by endpoints like</p>
<pre><code>/app/something/do-thing
</code></pre>
<p>which would perform some actions and respond with (usually) the same content and some additional contextual event information.
Needless to say over time more and more parts became serverside-rendered / HX-GET triggered by page load and have their own tiny ecosystem of functionalities and behaviors.</p>
<p>This is not that bad when you consider that SPA alternatives are the same with much much more code needed to make it happen.</p>
<h2 id="solution">Solution <a class="heading-anchor-permalink" href="#solution">#</a></h2>
<iframe src="https://microads.ftp.sh/api/ads/delivery-node/random?nonce=abc123"></iframe>
<p>For those who have already read <a href="https://hypermedia.systems">https://hypermedia.systems</a> this will seem obvious right away but I didn’t see it until I finished the book.
In a nutshell HTMX does what HTML is already supposed to be capable of, which is why people call it HTML6.</p>
<h3 id="asking-and-telling">Asking and telling <a class="heading-anchor-permalink" href="#asking-and-telling">#</a></h3>
<p>Hypermedia is just information at a certain URI. You can talk to hypermedia, you can ask it “how are you”</p>
<pre><code>curl -x GET https://httpbin.org/get
</code></pre>
<p>and it will respond.</p>
<p>You can tell hypermedia something</p>
<pre><code>curl -x POST http://httpbin.org/post -d 'query=books'
</code></pre>
<p>and it will respond.
That’s all there is to it (to “tell” you can use POST, PATCH, PUT, DELETE, et cetera).</p>
<p>Now, how do you build a complex hypermedia application or a system with just these two concepts? Asking and telling?</p>
<h3 id="screens-and-parts">Screens and parts <a class="heading-anchor-permalink" href="#screens-and-parts">#</a></h3>
<p>The approach I discovered works the best is one where you work top-down; start with the screen/page itself, let’s say we’re talking about a TODO app and it has</p>
<h4 id="screens">Screens <a class="heading-anchor-permalink" href="#screens">#</a></h4>
<ul>
<li>a menu/navbar of some kind and</li>
<li>it’s got a main “tasks” screen/page where it shows your tasks and lets you create a new one</li>
<li>it’s got a “settings” screen/page where it lets you change your preferences, toggle dark/light theme and whatnot</li>
<li>it’s got a “timeline” screen/page where you can see what happened when and so on</li>
</ul>
<p>so the routing would be like (let’s say it’s Flask but I don’t have to say this translates to Laravel/Express/Spring or what have you)</p>
<pre><code class="language-python">
@app.route(&quot;/&quot;, methods=[&quot;GET&quot;])
def tasks(...): ...

@app.route(&quot;/&lt;task_id&gt;&quot;, methods=[&quot;GET&quot;])
def show_task(task_id: int): ...

# ... and parts for tasks follow
# ...

@app.route(&quot;/settings&quot;, methods=[&quot;GET&quot;])
def settings(...): ...

@app.route(&quot;/settings/&lt;setting_name&gt;&quot;, methods=[&quot;GET&quot;])
def show_setting(setting_name: str): ...

# ... and parts for settings follow
# ...

@app.route(&quot;/timeline&quot;, methods=[&quot;GET&quot;])
def timeline(...): ...

@app.route(&quot;/timeline/&lt;moment&gt;&quot;, methods=[&quot;GET&quot;])
def timeline_moment(moment: int): ...

# ... and parts for timeline follow
# ...
</code></pre>
<h4 id="parts">Parts <a class="heading-anchor-permalink" href="#parts">#</a></h4>
<p>and for all hypermedia interactions you would create “part” routes like so:</p>
<pre><code class="language-python">
@app.route(&quot;/part/tasks&quot;, methods=[&quot;GET&quot;])
def list_tasks_part(...): ...

@app.route(&quot;/part/tasks/&lt;task_id&gt;&quot;, methods=[&quot;GET&quot;])
def show_task_part(task_id: int): ...

@app.route(&quot;/part/tasks&quot;, methods=[&quot;POST&quot;])
def store_task_part(body: dict): ...

@app.route(&quot;/part/tasks/&lt;task_id&gt;&quot;, methods=[&quot;PATCH&quot;])
def toggle_task_part(task_id: int): ... # imagine tasks can be enabled/disabled and they have an hx-patch trigger
</code></pre>
<p>and a similar approach would be applied to settings and to the timeline.</p>
<h4 id="reusable-parts">Reusable parts <a class="heading-anchor-permalink" href="#reusable-parts">#</a></h4>
<p>If there’s a common “component” (ie part) visible in all screens they would usually be defined as the first parts in the list of routes:</p>
<pre><code class="language-python">
@app.route(&quot;/part/settings/navmenu&quot;, methods=[&quot;GET&quot;])
def menu_part(...): ... # this way you can also have specialized menus in certain screens
...

@app.route(&quot;/part/settings&quot;, methods=[&quot;GET&quot;])
def list_settings_part(...): ...

@app.route(&quot;/part/settings/&lt;setting_name&gt;&quot;, methods=[&quot;GET&quot;])
def show_setting_part(setting_name: str): ...
</code></pre>
<p>the obvious benefit is reusability - the fact that the <code>menu_part</code> endpoint can be pointed at many different routes</p>
<ul>
<li>/part/tasks/navmenu</li>
<li>/part/settings/navmenu</li>
<li>/part/timeline/navmenu</li>
</ul>
<p>but they don’t have to be. Sure there is a bit of repetition but it’s RESTful and <em>really</em> scalable IMHO.</p>
<h4 id="specialized-parts">Specialized parts <a class="heading-anchor-permalink" href="#specialized-parts">#</a></h4>
<p>Any specialized parts or even static pages can be put between the reusable and CRUD routes, for example (because route order almost universally matters and if you want to avoid prefixing each route group):</p>
<ul>
<li>reusable
<ul>
<li>GET /part/tasks/navmenu</li>
<li>GET /part/tasks/footer</li>
</ul>
</li>
<li>specialized
<ul>
<li>GET /part/tasks/about (static “about” page)</li>
<li>GET /part/tasks/export (CSV export, for example, trigger could be rendered in <code>list_tasks_part</code> for example or in <code>show_task_part</code> to have a per-task export)</li>
</ul>
</li>
<li>CRUD
<ul>
<li>GET /part/tasks</li>
<li>GET /part/tasks/&lt;task_id&gt;</li>
<li>POST /part/tasks</li>
<li>PUT /part/tasks/&lt;task_id&gt;</li>
<li>DELETE /part/tasks/&lt;task_id&gt;</li>
<li>PATCH /part/tasks/&lt;task_id&gt;/enabled</li>
</ul>
</li>
</ul>
<h3 id="all-together">All together <a class="heading-anchor-permalink" href="#all-together">#</a></h3>
<p>You end up with a very clear pattern to where things are:</p>
<ul>
<li>screen
<ul>
<li>GET /</li>
<li>GET /&lt;task_id&gt;</li>
</ul>
</li>
<li>reusable
<ul>
<li>GET /part/tasks/navmenu</li>
<li>GET /part/tasks/footer</li>
</ul>
</li>
<li>specialized
<ul>
<li>GET /part/tasks/about</li>
<li>GET /part/tasks/export</li>
</ul>
</li>
<li>CRUD
<ul>
<li>GET /part/tasks</li>
<li>GET /part/tasks/&lt;task_id&gt;</li>
<li>POST /part/tasks</li>
<li>PUT /part/tasks/&lt;task_id&gt;</li>
<li>DELETE /part/tasks/&lt;task_id&gt;</li>
<li>PATCH /part/tasks/&lt;task_id&gt;/enabled</li>
</ul>
</li>
<li>screen
<ul>
<li>GET /settings</li>
<li>GET /settings/&lt;setting_name&gt;</li>
</ul>
</li>
<li>reusable
<ul>
<li>GET /part/settings/navmenu</li>
<li>GET /part/settings/footer</li>
</ul>
</li>
<li>specialized
<ul>
<li>GET /part/settings/export</li>
</ul>
</li>
<li>CRUD
<ul>
<li>GET /part/settings</li>
<li>GET /part/settings/&lt;setting_name&gt;</li>
<li>PATCH /part/settings/&lt;setting_name&gt;/enabled</li>
<li>PUT /part/settings/&lt;setting_name&gt;</li>
</ul>
</li>
<li>screen
<ul>
<li>GET /timeline</li>
<li>GET /timeline/&lt;moment&gt;</li>
</ul>
</li>
<li>reusable
<ul>
<li>GET /part/timeline/navmenu</li>
<li>GET /part/timeline/footer</li>
</ul>
</li>
<li>specialized
<ul>
<li>GET /part/timeline/export</li>
</ul>
</li>
<li>CRUD
<ul>
<li>GET /part/timeline</li>
<li>GET /part/timeline/&lt;moment&gt;</li>
</ul>
</li>
</ul>

      </article>
    </div>
    <script>
      // Load contents.json if you need it
    </script>
    <script>
      // FROM http://purecss.io/js/ui.js
      (function(window, document) {
        var layout = document.getElementById("layout"),
          menu = document.getElementById("menu"),
          menuLink = document.getElementById("menuLink");

        function toggleClass(element, className) {
          var classes = element.className.split(/\s+/),
            length = classes.length,
            i = 0;

          for (; i < length; i++) {
            if (classes[i] === className) {
              classes.splice(i, 1);
              break;
            }
          }
          // The className is not found
          if (length === classes.length) {
            classes.push(className);
          }

          element.className = classes.join(" ");
        }

        menuLink.onclick = function(e) {
          var active = "active";

          e.preventDefault();
          toggleClass(layout, active);
          toggleClass(menu, active);
          toggleClass(menuLink, active);
        };
      })(this, this.document);
    </script>
  </body>
</html>
